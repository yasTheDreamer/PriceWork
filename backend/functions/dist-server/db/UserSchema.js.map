{"version":3,"sources":["../../../server/db/UserSchema.js"],"names":["usersRef","admin","database","ref","writeUserData","user","userId","push","salary","jobTitle","address","country","state","zipCode","experience","email","timeStamp","socialLogin1","socialLogin2","readData","res","once","snapshot","status","json","summary","val","err","Error","recordExists","key","child","getRecordFromDB","docRef","updateRecord","data","updatedRecord","console","log","recordRef","update"],"mappings":"qMAAA;AACA,uD;;AAEA,IAAMA,QAAQ,GAAGC,yBAAMC,QAAN,GAAiBC,GAAjB,CAAqB,OAArB,CAAjB;;AAEO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAAU;AACrC,MAAMC,MAAM,GAAGN,QAAQ,CAACO,IAAT,CAAc;AAC3BC,IAAAA,MAAM,EAAEH,IAAI,CAACG,MADc;AAE3BC,IAAAA,QAAQ,EAAEJ,IAAI,CAACI,QAFY;AAG3BC,IAAAA,OAAO,EAAE;AACPC,MAAAA,OAAO,EAAEN,IAAI,CAACK,OAAL,CAAaC,OADf;AAEPC,MAAAA,KAAK,EAAEP,IAAI,CAACK,OAAL,CAAaE,KAFb;AAGPC,MAAAA,OAAO,EAAER,IAAI,CAACK,OAAL,CAAaG,OAHf,EAHkB;;AAQ3BC,IAAAA,UAAU,EAAET,IAAI,CAACS,UARU;AAS3BC,IAAAA,KAAK,EAAEV,IAAI,CAACU,KATe;AAU3BC,IAAAA,SAAS,EAAEX,IAAI,CAACW,SAVW;AAW3BC,IAAAA,YAAY,EAAEZ,IAAI,CAACY,YAXQ;AAY3BC,IAAAA,YAAY,EAAEb,IAAI,CAACa,YAZQ,EAAd,CAAf;;;AAeA,SAAOZ,MAAP;AACD,CAjBM,C;;AAmBA,IAAMa,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD,EAAS;AAC/BpB,EAAAA,QAAQ,CAACqB,IAAT;AACE,SADF;AAEE,YAACC,QAAD,EAAc;AACZF,IAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAE,+BAAWH,QAAQ,CAACI,GAAT,EAAX,CAAX,EAArB;AACD,GAJH;AAKE,YAACC,GAAD,EAAS;AACP,UAAM,IAAIC,KAAJ,CAAUD,GAAV,CAAN;AACD,GAPH;;AASD,CAVM,C;;AAYA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAS;AACnC,MAAI9B,QAAQ,CAAC+B,KAAT,CAAeD,GAAf,CAAJ,EAAyB,OAAO,IAAP;;AAEzB,SAAO,KAAP;AACD,CAJM,C;;AAMA,IAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACF,GAAD,EAAS;AACtC,MAAIG,MAAM,GAAG,IAAb;;AAEAA,EAAAA,MAAM,GAAGhC,yBAAMC,QAAN,GAAiBC,GAAjB,iBAA8B2B,GAA9B,EAAT;;AAEA,SAAOG,MAAM,CAACZ,IAAP;AACL,SADK;AAEL,YAACC,QAAD,EAAc;AACZ,WAAOA,QAAQ,CAACI,GAAT,EAAP;AACD,GAJI;AAKL,YAACC,GAAD,EAAS;AACP,UAAM,IAAIC,KAAJ,CAAUD,GAAV,CAAN;AACD,GAPI,CAAP;;AASD,CAdM,C;;AAgBA,IAAMO,YAAY,GAAG,SAAfA,YAAe,CAACJ,GAAD,EAAMK,IAAN,EAAe;AACzC,MAAIC,aAAJ;AACA,MAAIN,GAAG,IAAID,YAAY,CAACC,GAAD,CAAvB,EAA8B;AAC5BO,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACA,QAAIC,SAAS,GAAGvC,QAAQ,CAAC+B,KAAT,CAAeD,GAAf,CAAhB;AACAM,IAAAA,aAAa,GAAGG,SAAS,CAACC,MAAV,CAAiBL,IAAjB,EAAuB,YAAM;AAC3C,aAAOL,GAAP;AACD,KAFe,CAAhB;AAGD,GAND,MAMO;AACL,UAAM,IAAIF,KAAJ,CAAU,2CAAV,CAAN;AACD;;AAED,SAAOQ,aAAP;AACD,CAbM,C","sourcesContent":["import admin from \"./dbConnection\";\r\nimport { filterData } from \"../utils/utilFunctions\";\r\n\r\nconst usersRef = admin.database().ref(\"users\");\r\n\r\nexport const writeUserData = (user) => {\r\n  const userId = usersRef.push({\r\n    salary: user.salary,\r\n    jobTitle: user.jobTitle,\r\n    address: {\r\n      country: user.address.country,\r\n      state: user.address.state,\r\n      zipCode: user.address.zipCode,\r\n    },\r\n    experience: user.experience,\r\n    email: user.email,\r\n    timeStamp: user.timeStamp,\r\n    socialLogin1: user.socialLogin1,\r\n    socialLogin2: user.socialLogin2,\r\n  });\r\n\r\n  return userId;\r\n};\r\n\r\nexport const readData = (res) => {\r\n  usersRef.once(\r\n    \"value\",\r\n    (snapshot) => {\r\n      res.status(200).json({ summary: filterData(snapshot.val()) });\r\n    },\r\n    (err) => {\r\n      throw new Error(err);\r\n    }\r\n  );\r\n};\r\n\r\nexport const recordExists = (key) => {\r\n  if (usersRef.child(key)) return true;\r\n\r\n  return false;\r\n};\r\n\r\nexport const getRecordFromDB = (key) => {\r\n  let docRef = null;\r\n\r\n  docRef = admin.database().ref(`users/${key}`);\r\n\r\n  return docRef.once(\r\n    \"value\",\r\n    (snapshot) => {\r\n      return snapshot.val();\r\n    },\r\n    (err) => {\r\n      throw new Error(err);\r\n    }\r\n  );\r\n};\r\n\r\nexport const updateRecord = (key, data) => {\r\n  let updatedRecord;\r\n  if (key && recordExists(key)) {\r\n    console.log(\"here\");\r\n    let recordRef = usersRef.child(key);\r\n    updatedRecord = recordRef.update(data, () => {\r\n      return key;\r\n    });\r\n  } else {\r\n    throw new Error(\"key is not defined or record doesnt exist\");\r\n  }\r\n\r\n  return updatedRecord;\r\n};\r\n"],"file":"UserSchema.js"}